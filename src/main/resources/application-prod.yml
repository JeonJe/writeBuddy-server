spring:
  datasource:
    hikari:
      maximum-pool-size: 10          # Supabase connection pool과 함께 고려
      minimum-idle: 1               # 최소 연결 수 줄임
      connection-timeout: 20000     # 연결 타임아웃 줄임
      idle-timeout: 300000          # 유휴 타임아웃 줄임
      max-lifetime: 600000          # 최대 생명주기 줄임
      leak-detection-threshold: 60000
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false                 # 프로덕션에서는 SQL 로그 비활성화
    format-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect  # 명시적 dialect 설정

# 서버 설정 (프로덕션용)
server:
  port: ${PORT:7071}
  address: 0.0.0.0
  tomcat:
    connection-timeout: 180s        # HTTP 연결 타임아웃 3분 (프로덕션에서 더 길게)
    threads:
      max: 100                      # 프로덕션에서는 스레드 수 줄임
      min-spare: 5

# OpenAI 타임아웃 설정 (프로덕션용)
openai:
  timeout:
    connect: 15     # 연결 타임아웃
    read: 90        # 읽기 타임아웃 90초 (프로덕션에서 더 길게)

logging:
  level:
    com.writebuddy: INFO
    com.writebuddy.writebuddy.config.ApplicationStartupListener: INFO  # 시작 로그 허용
    org.springframework.web: WARN
    org.hibernate: WARN
    org.springframework.security: WARN
    com.zaxxer.hikari: INFO         # 연결 풀 정보
    org.apache.catalina.connector: WARN  # Tomcat 연결 에러 줄이기
    org.apache.coyote: WARN         # HTTP 프로토콜 에러 줄이기
    root: INFO                      # 기본 로그 레벨
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p [%t] %-40.40logger{39} : %m%n"
